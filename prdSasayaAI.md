# Sasaya AI - 產品需求文件 (PRD)

## 1. Summary

### 產品概述
Sasaya AI 是一個 Apple Mac App桌面應用程式，旨在將用戶分散在各處的 LLM AI 聊天記錄轉換為結構化的個人知識庫。透過一鍵匯入 AI 聊天記錄、自動分類和智慧搜尋，幫助用戶將過去的思考轉化為可搜尋、可組織的筆記系統。

### 核心價值主張
1. **一鍵轉換**：將 ChatGPT 聊天記錄轉換為結構化筆記，保留完整上下文
2. **自動組織**：使用 AI 自動分析內容並生成分類，讓想法不再散落
3. **智慧搜尋**：用戶可以在個人知識庫中快速找到任何想法和見解
4. **隱私優先**：所有資料儲存在用戶的電腦本地端，不上傳到任何雲端服務

### 目標用戶
- 經常使用 ChatGPT 或其他 AI 工具進行深度對話的人，可能是企業專業人士，也可能是個人工作者。
- 需要管理大量 AI 對話記錄的知識工作者。
- 希望建立個人知識庫的學習者和研究者。

### MVP 範圍
- 不包含帳號登入/註冊功能
- 專注於核心功能：匯入  ChatGPT 聊天記錄 zip 檔案、轉換成筆記、自動分類
- 目標：30 分鐘內可開發出可運作的 prototype

---

## 2. 功能需求

### 2.1 匯入功能
- **功能描述**：用戶可以匯入 ChatGPT 匯出的 .zip 檔案
- **支援格式**：標準 .zip 壓縮檔（包含 ChatGPT 匯出的 JSON 格式聊天記錄）
- **處理流程**：
  1. 用戶選擇 .zip 檔案 
  2. 系統解壓縮並解析 JSON 格式
  3. 將每個聊天轉換為筆記
  4. 顯示匯入進度
  5. 匯入完成後顯示統計資訊（如：匯入了 X 個對話、建立了 Y 個筆記）

### 2.2 筆記轉換功能
- **功能描述**：自動將 AI 聊天記錄轉換為結構化筆記
- **轉換規則**：
  - 保留對話的完整上下文（用戶問題 + AI 回答）
  - 提取對話標題作為筆記標題（如果 ChatGPT 匯出包含標題）
  - 保留時間戳記
  - 將對話內容格式化為易讀的筆記格式

### 2.3 自動分類功能
- **功能描述**：使用 AI 分析筆記內容並自動生成分類
- **分類邏輯**：
  - 分析筆記的主題、關鍵字和內容語義
  - 自動將相似主題的筆記歸類到同一分類
  - 生成有意義的分類名稱（如：產品管理、AI 與科技、個人成長等）
- **分類顯示**：在左側欄以資料夾圖示和名稱顯示

### 2.4 手動編輯功能
- **分類管理**：
  - 創建新分類
  - 編輯分類名稱
  - 刪除分類
  - 將筆記移動到不同分類
- **筆記管理**：
  - 編輯筆記標題
  - 編輯筆記內容（支援基本格式化：粗體、斜體、底線等）
  - 刪除筆記
  - 在分類間移動筆記

### 2.5 搜尋功能（MVP 版本）
- **功能描述**：在筆記中進行關鍵字搜尋
- **搜尋範圍選擇**：
  - 所有筆記
  - 特定分類（資料夾）
  - 特定筆記
- **搜尋行為**：
  - 即時搜尋（輸入時即顯示結果）
  - 高亮顯示匹配的關鍵字
  - 顯示搜尋結果列表（標題 + 預覽片段）

### 2.6 本地儲存
- **功能描述**：所有資料儲存在用戶的 Mac 本地
- **儲存位置**：應用程式專屬的本地資料庫或檔案系統
- **資料內容**：
  - 筆記內容
  - 分類結構
  - 筆記與分類的關聯
  - 用戶編輯記錄

### 2.7 空狀態處理
- **首次使用**：顯示歡迎筆記，介紹產品功能和使用方式
- **無筆記狀態**：顯示匯入提示和操作指引
- **無分類狀態**：顯示「未分類」分類，並提示可創建新分類

### 2.8 多語系支援 (i18n)
- **功能描述**：應用程式支援多語言介面切換
- **支援語言**：
  - 美式英文（預設語言）
  - 繁體中文（台灣）
- **語言切換**：
  - 用戶可在 Settings 面板中選擇語言
  - 語言選擇自動保存到本地（localStorage）
  - 切換語言時 UI 即時更新
- **翻譯範圍**：
  - 所有 UI 元素（按鈕、標籤、提示訊息、對話框等）
  - 分類名稱動態翻譯
  - 系統提示和錯誤訊息
  - AI 歡迎訊息

### 2.9 預設筆記語言策略
- **預設筆記**：應用程式預設範例筆記使用英文
- **用戶建立筆記**：
  - 新筆記標題跟隨當前 UI 語言（英文 UI → "Untitled Note"，中文 UI → "未命名筆記"）
  - 筆記內容可使用任何語言，由用戶自由輸入
- **匯入筆記**：
  - ChatGPT 對話匯入後保持原始語言
  - 不對匯入內容進行翻譯
  - 支援中英混合內容

### 2.10 設定功能 (Settings)
- **功能描述**：用戶可以進行應用程式的各項設定
- **UI 位置**：頂部導航欄最右側的 Settings 按鈕（齒輪圖示 ⚙️）
- **設定面板**：點擊 Settings 按鈕後彈出設定 Modal 對話框

#### 設定項目列表（完整規劃）
Settings 面板包含以下 10 個設定項目：

1. **個人資料 (Profile)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
2. **正在訂閱方案名稱 (Current Plan)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
3. **升級方案 (Upgrade Plan)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
4. **個人化 (Personalization)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
5. **通知 (Notifications)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
6. **資料控制 (Data Control)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
7. **應用程式語言 (Application Language)** - ✅ 已實作
   - 支援語言：美式英文、繁體中文（台灣）
   - 預設語言：美式英文
   - 選擇器：下拉選單或單選按鈕
   - 即時生效：切換語言後 UI 立即更新
   - 持久化：使用 localStorage 保存用戶選擇
   
8. **檢查更新 (Check for Updates)** - 未實作
   - 顯示項目但點擊後提示「即將推出 (Coming Soon)」
   
9. **Theme Color（主題顏色）** - ✅ 已實作
   - 選項：Light Mode（淺色模式）/ Dark Mode（深色模式）
   - 預設主題：Light Mode（淺色模式）
   - 選擇器：單選按鈕或切換開關
   - 即時生效：切換主題後 UI 立即更新所有顏色
   - 持久化：使用 localStorage 保存用戶選擇
   
10. **登出帳號 (Sign Out)** - 未實作
    - 顯示項目但點擊後提示「即將推出 (Coming Soon)」

#### MVP 實作範圍
- **目前實作**：第 7 項（應用程式語言）、第 9 項（Theme Color）
- **未實作項目**：其餘 8 項顯示在面板中，但點擊後顯示「即將推出 (Coming Soon)」提示訊息
- **未來擴展**：待後續開發階段逐步實作其他功能

---

## 3. 頁面結構

### 3.1 整體佈局
應用程式採用三欄式佈局（可選兩欄，右側 AI 對話區在 MVP 可簡化或省略）：

```
┌─────────────────────────────────────────────────────────┐
│ [視窗控制] [Integrations] [搜尋/提問/整理] [Note][Ask][Split][Organize] │
├──────────┬──────────────────────────┬───────────────────┤
│          │                          │                   │
│  左側欄   │      主內容區              │   右側 AI 對話區   │
│          │                          │   (MVP 可選)      │
│  - 分類  │  - 筆記編輯工具列          │  - Sasaya AI     │
│  - 筆記  │  - 筆記標題               │  - 對話介面       │
│  列表    │  - 筆記內容               │  - 搜尋範圍選擇    │
│          │  - 格式化工具             │                   │
│          │                          │                   │
└──────────┴──────────────────────────┴───────────────────┘
```

### 3.2 左側欄（Sidebar）
- **頂部操作區**：
  - `+` 按鈕：新增筆記
  - `山匯入` 按鈕：匯入 ChatGPT .zip 檔案
  - 搜尋框：「搜尋/提問/整理」
- **分類列表**：
  - 「未分類」（Uncategorized）
  - 自動生成的分類（如：個人成長、財經與投資、AI 與科技等）
  - 每個分類顯示：
    - 圖示（資料夾圖示）
    - 分類名稱
    - 展開/收合箭頭
- **筆記列表**：
  - 顯示當前分類下的所有筆記
  - 每個筆記顯示：
    - 筆記標題（截斷過長標題）
    - 時間戳記（如：01:35）
  - 當前選中的筆記高亮顯示
- **底部**：設定按鈕（齒輪圖示）

### 3.3 主內容區（Main Content Area）
- **工具列**：
  - 格式化按鈕：B（粗體）、I（斜體）、U（底線）、S（刪除線）、`</>`（程式碼）、Aa（字體選項）
  - 「AI 對話」按鈕（MVP 可選）
- **筆記標題**：可編輯的文字欄位
- **筆記內容**：
  - 可編輯的富文本區域
  - 支援基本格式化
  - 顯示對話轉換後的內容
- **空狀態**：
  - 歡迎筆記（首次使用）
  - 匯入提示（無筆記時）

### 3.4 右側 AI 對話區（Optional for MVP）
- **頂部**：
  - Sasaya AI 圖示和標題
  - 「您的智能知識助手」副標題
  - 關閉按鈕（X）
- **對話區域**：
  - 顯示 AI 的歡迎訊息和功能介紹
  - 顯示對話歷史（MVP 可簡化）
- **輸入區**：
  - 「搜尋範圍」選擇器：所有筆記 / 此資料夾 / 此筆記
  - 輸入框：「詢問任何問題...」
  - 發送按鈕（紙飛機圖示）
  - 提示文字：「按 Enter 發送，Shift + Enter 換行」

### 3.5 頂部導航欄
- **左側**：
  - 標準 macOS 視窗控制（紅、黃、綠）
  - Integrations 標籤
- **中間**：
  - 搜尋/提問/整理輸入框
- **右側**：
  - Note 按鈕
  - Ask 按鈕
  - Split 按鈕
  - Organize 按鈕
  - **Settings 按鈕**（齒輪圖示 ⚙️）

### 3.6 設定面板 (Settings Panel)
- **觸發方式**：點擊頂部導航欄右側的 Settings 按鈕
- **顯示方式**：Modal 對話框（居中顯示，背景半透明遮罩）
- **面板結構**：
  - **標題列**：
    - 標題文字：「Settings」或「設定」
    - 關閉按鈕：右上角 X 按鈕
  - **設定項目列表**（垂直排列，共 10 項）：
    1. 個人資料 (Profile) - 顯示但未實作
    2. 正在訂閱方案名稱 (Current Plan) - 顯示但未實作
    3. 升級方案 (Upgrade Plan) - 顯示但未實作
    4. 個人化 (Personalization) - 顯示但未實作
    5. 通知 (Notifications) - 顯示但未實作
    6. 資料控制 (Data Control) - 顯示但未實作
    7. **應用程式語言 (Application Language)** - ✅ 可互動
       - 下拉選單或單選按鈕：🇺🇸 English / 🇹🇼 繁體中文
       - 預設值：English
    8. 檢查更新 (Check for Updates) - 顯示但未實作
    9. **Theme Color（主題顏色）** - ✅ 可互動
       - 單選按鈕或切換開關：☀️ Light / 🌙 Dark
       - 預設值：Light
    10. 登出帳號 (Sign Out) - 顯示但未實作
  - **項目樣式區分**：
    - 已實作項目（7, 9）：正常顏色，可點擊
    - 未實作項目（1-6, 8, 10）：灰色文字，點擊後顯示 Toast 提示「即將推出 (Coming Soon)」
- **互動行為**：
  - 切換語言或主題後立即生效（無需確認）
  - 點擊未實作項目顯示「即將推出」提示（2 秒後自動消失）
  - 關閉面板時自動保存設定到 localStorage
  - 可點擊面板外部區域關閉
  - 按 ESC 鍵關閉

---

## 4. User Stories & Acceptance Criteria

### US-1: 匯入 ChatGPT 聊天記錄
**作為** 一個用戶  
**我想要** 匯入 ChatGPT 匯出的 .zip 檔案  
**以便** 將我的聊天記錄轉換為筆記

**Acceptance Criteria:**
- [ ] 用戶可以透過「匯入」按鈕選擇 .zip 檔案
- [ ] 系統能夠解壓縮 .zip 檔案並解析其中的 JSON 格式
- [ ] 系統顯示匯入進度（如：正在處理 50/200 個對話）
- [ ] 匯入完成後顯示統計資訊（匯入了 X 個對話，建立了 Y 個筆記）
- [ ] 如果檔案格式錯誤，顯示明確的錯誤訊息
- [ ] 匯入的筆記出現在左側欄的筆記列表中

### US-2: 自動將聊天轉換為筆記
**作為** 一個用戶  
**我想要** 系統自動將聊天記錄轉換為結構化筆記  
**以便** 保留對話的完整上下文

**Acceptance Criteria:**
- [ ] 每個聊天記錄被轉換為一個獨立的筆記
- [ ] 筆記標題來自聊天標題（如果存在）或自動生成
- [ ] 筆記內容包含完整的對話內容（用戶問題 + AI 回答）
- [ ] 筆記保留原始時間戳記
- [ ] 筆記內容格式化為易讀的格式

### US-3: 自動分類筆記
**作為** 一個用戶  
**我想要** 系統自動分析筆記內容並生成分類  
**以便** 將相關的筆記組織在一起

**Acceptance Criteria:**
- [ ] 系統使用 AI 分析筆記內容的主題和語義
- [ ] 系統自動生成有意義的分類名稱（如：產品管理、AI 與科技）
- [ ] 相似主題的筆記被歸類到同一分類
- [ ] 分類顯示在左側欄，以資料夾圖示呈現
- [ ] 未分類的筆記顯示在「未分類」分類下
- [ ] 分類可以展開/收合以顯示其中的筆記

### US-4: 手動創建和編輯分類
**作為** 一個用戶  
**我想要** 手動創建、編輯和組織分類  
**以便** 按照我的方式組織筆記

**Acceptance Criteria:**
- [ ] 用戶可以點擊「+」或右鍵選單創建新分類
- [ ] 用戶可以編輯分類名稱
- [ ] 用戶可以刪除分類（需確認，避免誤刪）
- [ ] 用戶可以將筆記拖拽到不同分類
- [ ] 分類變更立即反映在左側欄

### US-5: 編輯筆記
**作為** 一個用戶  
**我想要** 編輯筆記的標題和內容  
**以便** 完善和更新我的知識庫

**Acceptance Criteria:**
- [ ] 用戶可以點擊筆記標題進行編輯
- [ ] 用戶可以在主內容區編輯筆記內容
- [ ] 支援基本格式化：粗體、斜體、底線、刪除線、程式碼
- [ ] 編輯後自動儲存（或提供儲存按鈕）
- [ ] 變更立即反映在筆記列表中

### US-6: 搜尋筆記（關鍵字搜尋）
**作為** 一個用戶  
**我想要** 在筆記中搜尋關鍵字  
**以便** 快速找到相關的內容

**Acceptance Criteria:**
- [ ] 用戶可以在頂部搜尋框輸入關鍵字
- [ ] 系統即時顯示搜尋結果（輸入時即更新）
- [ ] 搜尋結果高亮顯示匹配的關鍵字
- [ ] 搜尋結果顯示筆記標題和包含關鍵字的預覽片段
- [ ] 點擊搜尋結果可以打開對應的筆記
- [ ] 支援在「所有筆記」、「特定分類」、「特定筆記」範圍內搜尋

### US-7: 選擇搜尋範圍
**作為** 一個用戶  
**我想要** 選擇搜尋的範圍（所有筆記 / 特定分類 / 特定筆記）  
**以便** 縮小搜尋範圍，找到更精確的結果

**Acceptance Criteria:**
- [ ] 在搜尋框或 AI 對話區提供範圍選擇器
- [ ] 選項包括：「所有筆記」、「此資料夾」、「此筆記」
- [ ] 選擇範圍後，搜尋只在該範圍內進行
- [ ] 當前選擇的範圍清楚標示

### US-8: 查看歡迎筆記
**作為** 一個新用戶  
**我想要** 看到歡迎筆記和功能介紹  
**以便** 了解如何使用應用程式

**Acceptance Criteria:**
- [ ] 首次打開應用程式時顯示歡迎筆記
- [ ] 歡迎筆記包含產品介紹和主要功能說明
- [ ] 歡迎筆記提供使用指引（如：如何匯入、如何搜尋）
- [ ] 用戶可以編輯或刪除歡迎筆記

### US-9: 本地儲存
**作為** 一個用戶  
**我想要** 所有資料儲存在本地  
**以便** 保護我的隱私

**Acceptance Criteria:**
- [ ] 所有筆記和分類資料儲存在 Mac 本地
- [ ] 資料不會上傳到任何雲端服務
- [ ] 應用程式關閉後重新打開，資料仍然存在
- [ ] 資料儲存位置在應用程式專屬目錄中

### US-10: 使用設定面板
**作為** 一個用戶  
**我想要** 訪問應用程式的設定面板  
**以便** 調整語言、主題等個人偏好設定

**Acceptance Criteria:**
- [ ] 用戶可以點擊頂部導航欄右側的 Settings 按鈕（⚙️）
- [ ] 開啟設定 Modal 對話框，顯示完整的 10 個設定項目
- [ ] 設定項目包括：
  - [ ] 個人資料（顯示但未實作）
  - [ ] 正在訂閱方案名稱（顯示但未實作）
  - [ ] 升級方案（顯示但未實作）
  - [ ] 個人化（顯示但未實作）
  - [ ] 通知（顯示但未實作）
  - [ ] 資料控制（顯示但未實作）
  - [ ] **應用程式語言**（可互動）
  - [ ] 檢查更新（顯示但未實作）
  - [ ] **Theme Color**（可互動）
  - [ ] 登出帳號（顯示但未實作）
- [ ] 已實作項目（語言、主題）正常顯示，可點擊互動
- [ ] 未實作項目顯示為灰色，點擊後顯示「即將推出 (Coming Soon)」Toast 提示
- [ ] 用戶可以在設定面板中切換語言（🇺🇸 English / 🇹🇼 繁體中文）
- [ ] 用戶可以在設定面板中切換主題（☀️ Light / 🌙 Dark）
- [ ] 切換語言或主題後 UI 立即更新
- [ ] 語言和主題選擇自動保存到 localStorage
- [ ] 下次開啟應用程式時保持上次選擇的語言和主題
- [ ] 預設語言為 English，預設主題為 Light Mode
- [ ] 可以點擊 X 按鈕、面板外部區域或按 ESC 鍵關閉設定面板

---

## 5. 技術細節

### 5.1 資料儲存
- **儲存方案**：
  - 選項 1：使用 SQLite 資料庫（推薦，易於查詢和管理）
  - 選項 2：使用 JSON 檔案（簡單，但查詢效率較低）
- **資料結構**：
  ```json
  {
    "categories": [
      {
        "id": "cat_001",
        "name": "產品管理",
        "icon": "chart",
        "createdAt": "2025-01-01T00:00:00Z"
      }
    ],
    "notes": [
      {
        "id": "note_001",
        "title": "筆記標題",
        "content": "筆記內容...",
        "categoryId": "cat_001",
        "createdAt": "2025-01-01T00:00:00Z",
        "updatedAt": "2025-01-01T00:00:00Z",
        "sourceChatId": "chat_001"
      }
    ]
  }
  ```
- **儲存位置**：`~/Library/Application Support/SasayaAI/` 或應用程式沙盒目錄

### 5.2 檔案格式處理
- **ChatGPT 匯出格式**：
  - 標準 .zip 壓縮檔
  - 解壓縮後包含 JSON 格式的聊天記錄
  - JSON 結構範例（需根據實際 ChatGPT 匯出格式調整）：
    ```json
    {
      "conversations": [
        {
          "id": "chat_001",
          "title": "對話標題",
          "createdAt": "2025-01-01T00:00:00Z",
          "messages": [
            {
              "role": "user",
              "content": "用戶問題"
            },
            {
              "role": "assistant",
              "content": "AI 回答"
            }
          ]
        }
      ]
    }
    ```
- **處理流程**：
  1. 驗證 .zip 檔案格式
  2. 解壓縮檔案
  3. 解析 JSON 結構
  4. 轉換為筆記格式
  5. 儲存到本地資料庫

### 5.3 錯誤處理
- **匯入錯誤**：
  - 檔案格式不正確：顯示「無法識別的檔案格式，請確認這是 ChatGPT 匯出的 .zip 檔案」
  - 檔案損壞：顯示「檔案損壞，無法讀取」
  - 匯入過程中斷：顯示「匯入失敗，請重試」
- **儲存錯誤**：
  - 磁碟空間不足：顯示「儲存空間不足，請清理磁碟空間」
  - 權限問題：顯示「無法寫入資料，請檢查應用程式權限」
- **搜尋錯誤**：
  - 無搜尋結果：顯示「未找到匹配的內容」
  - 搜尋失敗：顯示「搜尋時發生錯誤，請重試」

### 5.4 空狀態處理
- **首次使用**：
  - 顯示預設的歡迎筆記
  - 歡迎筆記內容包含產品介紹和使用指引
  - 左側欄顯示「未分類」分類
- **無筆記狀態**：
  - 主內容區顯示匯入提示
  - 提示文字：「點擊左側的「匯入」按鈕，匯入您的 ChatGPT 聊天記錄」
  - 顯示匯入按鈕或操作指引
- **無分類狀態**：
  - 所有筆記顯示在「未分類」分類下
  - 提示用戶可以創建新分類

### 5.5 自動分類 AI 整合（MVP 後續實作）
- **MVP 階段**：可先使用簡單的關鍵字匹配或規則分類
- **後續版本**：整合 AI API（如 OpenAI API）進行語義分析
- **分類邏輯**：
  - 分析筆記內容的主題
  - 提取關鍵字和概念
  - 與現有分類進行相似度匹配
  - 生成新分類或歸類到現有分類

### 5.6 搜尋功能實作（MVP 版本）
- **搜尋方式**：關鍵字全文搜尋
- **搜尋範圍**：
  - 筆記標題
  - 筆記內容
- **搜尋演算法**：
  - 簡單的字串匹配（MVP）
  - 可選：不區分大小寫
  - 可選：支援部分匹配
- **效能考量**：
  - 對於大量筆記，考慮建立索引
  - 使用背景執行，避免阻塞 UI

### 5.7 UI/UX 細節
- **深色主題**：應用程式採用深色模式設計
- **響應式設計**：支援視窗大小調整
- **載入狀態**：
  - 匯入時顯示進度條
  - 處理大量資料時顯示載入動畫
- **確認對話框**：
  - 刪除分類時確認
  - 刪除筆記時確認
  - 匯入大量資料時確認

### 5.8 多語系實現 (i18n)
- **技術框架**：
  - 使用 `i18next` + `react-i18next` 進行國際化
  - 版本：i18next ^23.x, react-i18next ^15.x
- **翻譯檔案結構**：
  ```
  src/
  ├── i18n/
  │   ├── config.js              # i18n 配置檔案
  │   └── locales/
  │       ├── en.json            # 英文翻譯
  │       └── zh-TW.json         # 繁體中文翻譯
  ```
- **配置說明**：
  - 預設語言：`en`（英文）
  - 備用語言：`en`（當翻譯缺失時使用）
  - 語言儲存：使用 `localStorage.getItem('language')`
  - 初始化時從 localStorage 讀取用戶上次選擇的語言
- **翻譯鍵結構**：
  ```json
  {
    "topBar": { "integrations": "...", "note": "..." },
    "sidebar": { "create": "...", "import": "..." },
    "editor": { "titlePlaceholder": "...", "contentPlaceholder": "..." },
    "ai": { "title": "...", "welcome": "..." },
    "categories": { "uncategorized": "...", "personal": "..." }
  }
  ```
- **分類名稱翻譯**：
  - 使用 `categoryId` 進行映射
  - 在 App 組件中動態翻譯分類名稱
  - 支援切換語言時即時更新
- **實現細節**：
  - 在 `main.jsx` 中引入 i18n 配置
  - 在組件中使用 `useTranslation()` hook
  - 使用 `t('key')` 函數進行翻譯
  - 語言切換時調用 `i18n.changeLanguage(lng)`

### 5.9 主題系統實現 (Theme System)
- **技術方案**：
  - 使用 CSS 變數 (CSS Custom Properties) 管理主題色彩
  - 主題儲存：使用 `localStorage.setItem('theme', 'dark'|'light')`
  - 初始化時從 localStorage 讀取主題設定，預設為 'light'
  - 動態切換：透過修改 `document.documentElement` 的 `data-theme` 屬性
- **CSS 變數結構**：
  ```css
  /* Dark Theme */
  :root[data-theme="dark"] {
    --bg-primary: #1e1e1e;
    --bg-secondary: #2d2d2d;
    --bg-tertiary: #3d3d3d;
    --text-primary: #ffffff;
    --text-secondary: #d0d0d0;
    --text-tertiary: #a0a0a0;
    --border-color: #505050;
    --accent-color: #0066cc;
    --hover-bg: #404040;
    --input-bg: #2d2d2d;
    --shadow: rgba(0, 0, 0, 0.3);
  }
  
  /* Light Theme (預設) */
  :root[data-theme="light"] {
    --bg-primary: #ffffff;
    --bg-secondary: #f5f5f5;
    --bg-tertiary: #e8e8e8;
    --text-primary: #000000;
    --text-secondary: #333333;
    --text-tertiary: #666666;
    --border-color: #dddddd;
    --accent-color: #0066cc;
    --hover-bg: #f0f0f0;
    --input-bg: #ffffff;
    --shadow: rgba(0, 0, 0, 0.1);
  }
  ```
- **實現細節**：
  - 在 App 組件中管理 `theme` state
  - 使用 `useEffect` 在初始化時讀取並應用保存的主題
  - 切換主題函數：
    ```javascript
    const toggleTheme = (newTheme) => {
      setTheme(newTheme);
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    };
    ```
  - 所有現有 CSS 需重構為使用 CSS 變數而非硬編碼顏色值
  - Settings Modal 中提供 Light/Dark 單選按鈕或切換開關
- **過渡動畫**（可選）：
  - 主題切換時添加平滑過渡效果
  - 使用 CSS transition: `transition: background-color 0.3s, color 0.3s;`

---

## 6. 開發 Phases

### Phase 1: 核心基礎架構（優先級：最高）
**目標**：建立基本的應用程式框架和資料儲存

**任務**：
1. 建立 Mac 應用程式專案結構
2. 實作本地資料儲存（SQLite 或 JSON）
3. 建立基本的 UI 框架（三欄式佈局）
4. 實作左側欄（分類和筆記列表）
5. 實作主內容區（筆記顯示和編輯）
6. 實作基本的資料模型（Category、Note）

**預估時間**：10-15 分鐘

### Phase 2: 匯入和轉換功能（優先級：高）
**目標**：實作 ChatGPT 匯入和筆記轉換

**任務**：
1. 實作 .zip 檔案選擇和讀取
2. 實作 JSON 解析（ChatGPT 匯出格式）
3. 實作聊天記錄轉換為筆記的邏輯
4. 實作匯入進度顯示
5. 實作匯入完成統計顯示
6. 實作錯誤處理

**預估時間**：8-10 分鐘

### Phase 3: 分類管理（優先級：高）
**目標**：實作分類的創建、編輯和組織

**任務**：
1. 實作「未分類」預設分類
2. 實作創建新分類功能
3. 實作編輯分類名稱
4. 實作刪除分類（含確認對話框）
5. 實作筆記在分類間移動（拖拽或選單）
6. 實作分類展開/收合

**預估時間**：5-8 分鐘

### Phase 4: 筆記編輯（優先級：中）
**目標**：實作筆記的編輯和格式化

**任務**：
1. 實作筆記標題編輯
2. 實作筆記內容編輯（富文本編輯器）
3. 實作基本格式化工具（粗體、斜體、底線等）
4. 實作自動儲存或手動儲存
5. 實作刪除筆記功能

**預估時間**：5-7 分鐘

### Phase 5: 搜尋功能（優先級：中）
**目標**：實作關鍵字搜尋

**任務**：
1. 實作搜尋輸入框
2. 實作關鍵字全文搜尋邏輯
3. 實作搜尋結果顯示（高亮匹配文字）
4. 實作搜尋範圍選擇（所有筆記 / 分類 / 單一筆記）
5. 實作即時搜尋（輸入時更新結果）

**預估時間**：5-7 分鐘

### Phase 6: 自動分類（優先級：中低，MVP 可簡化）
**目標**：實作 AI 自動分類（MVP 可先做簡單版本）

**任務**：
1. **MVP 簡化版本**：
   - 使用關鍵字匹配進行簡單分類
   - 預設幾個常見分類（產品管理、AI 與科技、個人成長等）
   - 根據關鍵字將筆記分配到對應分類
2. **完整版本**（後續實作）：
   - 整合 AI API 進行語義分析
   - 自動生成分類名稱
   - 智能歸類筆記

**預估時間**：MVP 版本 3-5 分鐘，完整版本後續實作

### Phase 7: 空狀態和歡迎筆記（優先級：低）
**目標**：改善首次使用體驗

**任務**：
1. 實作歡迎筆記（預設內容）
2. 實作無筆記狀態的提示
3. 實作無分類狀態的處理
4. 實作匯入指引

**預估時間**：3-5 分鐘

### Phase 8: 右側 AI 對話區（優先級：低，MVP 可選）
**目標**：實作 AI 對話介面（MVP 可先省略或簡化）

**任務**：
1. 實作右側對話面板（可選，MVP 可先不做）
2. 實作搜尋範圍選擇器
3. 實作對話輸入框
4. **MVP 階段**：可先只做搜尋範圍選擇，AI 對話功能後續實作

**預估時間**：5-8 分鐘（如實作）

### 開發順序建議
1. **Phase 1** → 建立基礎架構
2. **Phase 2** → 實作匯入功能（核心功能）
3. **Phase 3** → 實作分類管理（核心功能）
4. **Phase 4** → 實作筆記編輯（核心功能）
5. **Phase 5** → 實作搜尋功能（核心功能）
6. **Phase 6** → 實作自動分類（MVP 簡化版本）
7. **Phase 7** → 改善空狀態體驗
8. **Phase 8** → AI 對話區（可選，MVP 可省略）

### MVP 最小可行功能
為了在 30 分鐘內完成 prototype，建議優先實作：
- ✅ Phase 1: 基礎架構
- ✅ Phase 2: 匯入和轉換
- ✅ Phase 3: 分類管理（手動）
- ✅ Phase 4: 筆記編輯（基本）
- ✅ Phase 5: 搜尋功能（關鍵字）
- ⚠️ Phase 6: 自動分類（簡化版本，使用關鍵字匹配）
- ⚠️ Phase 7: 空狀態（基本處理）
- ❌ Phase 8: AI 對話區（可省略，後續實作）

---

## 7. 技術堆疊建議

### 開發框架
- **SwiftUI**（推薦）：Mac 原生開發，UI 構建快速
- **Electron**（備選）：跨平台，但檔案較大

### 資料儲存
- **SQLite**（推薦）：輕量、高效、易於查詢
- **Core Data**（備選）：macOS 原生，但較複雜
- **JSON 檔案**（最簡單）：適合 MVP，但查詢效率低

### 檔案處理
- **Foundation Framework**：處理 .zip 解壓縮和 JSON 解析

### AI 整合（後續版本）
- **OpenAI API**：用於自動分類和 AI 對話
- **本地 AI 模型**（備選）：如 Core ML，但需要預訓練模型

---

## 8. 後續擴展功能（非 MVP）

- 帳號系統和雲端同步
- 完整的 AI 對話功能（整合 AI API）
- 進階搜尋（語義搜尋、模糊搜尋）
- 筆記連結和關係圖
- 匯出功能（Markdown、PDF 等）
- 更多語言支援（日文、韓文、西班牙文等）
- 更多設定選項（字體大小、編輯器偏好、自動儲存間隔等）
- 筆記模板
- 標籤系統
- 版本歷史記錄

---

## 附錄：參考資料

### ChatGPT 匯出格式說明
ChatGPT 匯出的 .zip 檔案通常包含：
- `conversations.json`：包含所有對話記錄
- 可能的其他檔案（如附件、圖片等）

實際格式可能因 ChatGPT 版本而異，開發時需根據實際匯出格式調整解析邏輯。

### 設計參考
- 參考截圖展示了三欄式佈局和深色主題設計
- 左側欄的分類和筆記列表結構
- 主內容區的筆記編輯介面
- 右側 AI 對話區的設計（MVP 可選）

---

**文件版本**：v1.0  
**最後更新**：2025-01-08  
**文件狀態**：MVP 版本，供 prototype 開發使用

